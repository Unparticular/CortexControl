<?xml version="1.0" encoding="utf-8"?>
<Defs>
    <!-- ================= Implant Hediff Base RecipeDef ================= -->
    <HediffDef Name="CC_ImplantHediffBase" ParentName="ImplantHediffBase" Abstract="True">
        <duplicationAllowed>false</duplicationAllowed>
        <tags>
            <li>CC_Implant</li>
        </tags>
    </HediffDef>

    <!-- ================= Implant Install Base RecipeDef ================= -->
    <RecipeDef Name="CC_InstallImplantBase" ParentName="SurgeryInstallImplantBase" Abstract="True">
        <workerClass>CortexControl.Recipe_InstallImplantWithBrainwash</workerClass>
        <isViolation>true</isViolation>
        <anesthetize>true</anesthetize>
        <incompatibleWithHediffTags>
            <li>CC_Implant</li>
        </incompatibleWithHediffTags>
        <appliedOnFixedBodyParts>
            <li>Brain</li>
        </appliedOnFixedBodyParts>
        <modExtensions>
            <li Class="CortexControl.CCRecipeDefModExtension">
                <hediffsToRemove>
                    <li>CC_FracturedMind</li>
                    <li>CC_CognitiveRewiring</li>
                </hediffsToRemove>
            </li>
        </modExtensions>
    </RecipeDef>

    <!-- ================= Implant Remove Base RecipeDef ================= -->
    <RecipeDef Name="CC_RemoveImplantBase" ParentName="SurgeryRemoveImplantBase" Abstract="True">
        <workerClass>CortexControl.Recipe_RemoveImplantControl</workerClass>
        <isViolation>true</isViolation>
        <anesthetize>true</anesthetize>
        <appliedOnFixedBodyParts>
            <li>Brain</li>
        </appliedOnFixedBodyParts>
        <addsHediff>CC_FracturedMind</addsHediff>
        <deathOnFailedSurgeryChance>0.4</deathOnFailedSurgeryChance>
        <surgerySuccessChanceFactor>0.4</surgerySuccessChanceFactor>
        <ingredients Inherit="False">
            <li>
                <filter><categories><li>Medicine</li></categories></filter>
                <count>2</count>
            </li>
        </ingredients>
        <fixedIngredientFilter Inherit="False">
            <categories>
                <li>Medicine</li>
            </categories>
        </fixedIngredientFilter>
    </RecipeDef>

    <!-- ================= Chip Reprogramming RecipeDef ================= -->

    <RecipeDef ParentName="SurgeryFlesh">
        <defName>CC_ChipReprogramming</defName>
        <label>reprogram control chip</label>
        <description>Many times when conquering other nations or capturing enemies, people have found those who already had chips implanted in them. Instead of going through the effort of removing the old chip and implanting their own, they developed ways to safely reprogram the chip to change their allegiance. \n\nReprogramming control chips is considered to be a hostile action.</description>
        <descriptionHyperlinks>
            <ThingDef>CC_StandardControlChip</ThingDef>
            <ThingDef>CC_GuidanceChip</ThingDef>
            <ThingDef>CC_NullChip</ThingDef>
        </descriptionHyperlinks>
        <jobString>Reprogramming control chip.</jobString>
        <appliedOnFixedBodyParts>
            <li>Brain</li>
        </appliedOnFixedBodyParts>
        <workerClass>CortexControl.Recipe_ReprogramControlChip</workerClass>
        <isViolation>true</isViolation>
        <anesthetize>true</anesthetize>
        <workAmount>1000</workAmount>
        <deathOnFailedSurgeryChance>0</deathOnFailedSurgeryChance>
        <surgerySuccessChanceFactor>5</surgerySuccessChanceFactor>
        <skillRequirements>
            <Crafting>8</Crafting>
            <Medicine>4</Medicine>
        </skillRequirements>
        <ingredients Inherit="False">
            <li>
                <filter><categories><li>Medicine</li></categories></filter>
                <count>2</count>
            </li>
        </ingredients>
        <fixedIngredientFilter Inherit="False">
            <categories>
                <li>Medicine</li>
            </categories>
        </fixedIngredientFilter>
        <modExtensions>
            <li Class="CortexControl.CCRecipeDefModExtension">
                <requiredHediffs>
                    <li>CC_StandardControlChip</li>
                    <li>CC_GuidanceChip</li>
                    <li>CC_NullChip</li>
                </requiredHediffs>
            </li>
        </modExtensions>
        <recipeUsers>
            <li>Human</li>
            <li MayRequire="Ludeon.RimWorld.Anomaly">CreepJoiner</li>
        </recipeUsers>
        <developmentalStageFilter>Child, Adult</developmentalStageFilter>
        <researchPrerequisite>CC_ChipReprogramming</researchPrerequisite>
    </RecipeDef>
</Defs>